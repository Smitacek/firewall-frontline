# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with the Firewall Frontline codebase.

## Project: Firewall Frontline

### Project Overview
A neon-retro lane-defense game where players deploy cybersecurity "modules" to fend off escalating hacker attacks. Educational goal: teach core security principles (defense-in-depth, least privilege, patch management) without technical jargon.

### Game Type
- Tower/Lane Defense (inspired by Plants vs Zombies)
- Educational cybersecurity game
- Pixel art style with neon palette

## Technology Stack

### Engine & Tools
- **Game Engine:** Godot 4.x LTS
- **Primary Language:** GDScript 2.0
- **Optional Performance:** C# (Mono) .NET 8
- **Version Control:** Git + GitHub
- **CI/CD:** GitHub Actions
- **Testing:** WAT (godot-unit)
- **Static Analysis:** gdtoolkit linter

## Project Structure

```
/                    # repo root
├── .github/
│   └── workflows/   # CI YAML
├── addons/          # third-party Godot addons (submodules)
├── assets/
│   ├── art/         # 32x32 pixel-art sprites
│   ├── audio/       # retro modem beeps, synth effects
│   └── fonts/
├── data/            # balance tables, JSON, TSV
├── domain/          # pure-logic scripts (no Node)
├── gui/             # Control scenes (HUD, menus)
├── scenes/          # Node-based prefabs & levels
├── ai/              # enemy FSM scripts
├── tests/           # WAT unit/integration tests
├── docs/            # design docs (GDD, TDD, retros)
└── exports/         # output builds via CI
```

### Important Rules
- Only `scenes/` contains `.tscn` files
- Pure logic stays under `domain/` for unit testing
- Use signals over singletons
- Dependency injection for testability

## Development Guidelines

### Code Style
- **Indentation:** 4 spaces
- **Line length:** 100 characters max
- **Naming conventions:**
  - `snake_case` for functions & variables
  - `PascalCase` for classes
- **Language:** English for all code, comments, and documentation
- **Communication:** Czech (as per user preference)

### Architecture Principles
- Separation of concerns (MVC-like):
  - `gui/` - Pure View (Control nodes, HUD, menus)
  - `domain/` - Models (gameplay logic, no Node code)
  - `scenes/` - Composed prefabs (GUI + Domain via Signals)
- Data-driven balance (JSON/TSV files in `data/`)
- State machines for AI behavior

### Testing Requirements
- Unit-test first for domain logic
- Aim for ≥70% coverage before Beta
- Mock single-player waves for CI
- Run tests with: `godot --headless --run-tests`

## Common Development Commands

### Godot Development
```bash
# Open editor
godot --editor

# Run tests
godot --headless --run-tests

# Export game
godot --headless --export-release "Windows Desktop" exports/Firewall.exe

# Run linter (if gdtoolkit installed)
gdformat --check .
gdparse --check .
```

### Git Workflow
```bash
git status
git add .
git commit -m "feat: implement Power Node CPU generation"
git push
```

### Local Development Setup
1. Clone repo with submodules: `git clone --recursive [repo-url]`
2. Install Godot 4.x LTS + matching export templates
3. Run `godot --editor` - project opens at `scenes/Main.tscn`
4. Pre-commit hook runs gd-linter & unit tests

## Game-Specific Implementation Notes

### Module System
- Defensive modules: Power Node, Firewall, IDS, Honeypot, Sandbox, AntiVirus
- Each module has: cost (CPU), cooldown, upgrade path
- Damage channels: Packet, Payload, Social, Zero-Day

### Enemy Types
- T1: Script Kiddie, Spam Bot
- T2: Phishing Spear, Botnet Swarm
- T3: Trojan Horse
- T4: Zero-Day Exploit
- Boss: APT "Black-Hat AI"

### Resource Economy
- CPU Cycles: Generated by Power Nodes, spent on modules
- Research Tokens: Earned from waves, spent on upgrades
- Bandwidth (stretch goal): Temporary buffs

### Visual Style
- 32×32 pixel-art sprites
- Neon palette: #08F (blue), #0F0 (green), #F0F (pink)
- Clear silhouettes for readability

## Performance Guidelines
- Use MultiMesh for identical projectiles
- Fixed timestep 60 Hz
- A* pathfinding cache per lane
- Pool arrays for attacker instances

## CI/CD Pipeline
- Triggers on push & PR
- Compiles, tests, exports for ubuntu-latest & windows-latest
- Tag `vX.Y.*` publishes to GitHub Releases
- See `.github/workflows/` for details

## Current Development Phase
**Vertical Slice Implementation:**
- Implement lanes, CPU drop system
- Add four modules (PWR, FWL, HPT, IDS) and Script Kiddie enemy
- One tutorial level + Endless sandbox
- Collect first external playtest feedback

## Important Notes
- All third-party assets require CC0/CC-BY licenses recorded in `resources.md`
- Headless build must compile via CI on every push
- Follow security best practices - no hardcoded secrets
- Test thoroughly before marking features complete